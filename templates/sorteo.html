{% extends 'base.html' %}

{% block content %}
<div class="card">
    <h2>Sorteo de Equipos</h2>
    
    {% if messages %}
        {% for message in messages %}
            <div class="card" style="background: {% if message.tags == 'error' %}rgba(255,0,0,0.3){% else %}rgba(0,255,0,0.3){% endif %}; text-align: center;">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div>
            <h3>Agregar Equipo</h3>
            <form method="post">
                {% csrf_token %}
                <input type="text" name="nombre" placeholder="Nombre del equipo" required style="width: 100%; padding: 10px; margin: 5px 0; border-radius: 5px; border: none;">
                <input type="text" name="escuela" placeholder="Escuela (opcional)" style="width: 100%; padding: 10px; margin: 5px 0; border-radius: 5px; border: none;">
                <button type="submit" name="agregar_equipo">Agregar Equipo</button>
            </form>
        </div>
        
        <div>
            <h3>Equipos Registrados ({{ equipos.count }})</h3>
            <ul style="list-style: none; padding: 0;">
                {% for equipo in equipos %}
                <li style="background: rgba(255,255,255,0.2); padding: 10px; margin: 5px 0; border-radius: 5px;">
                    {{ equipo.nombre }}{% if equipo.escuela %} - {{ equipo.escuela }}{% endif %}
                </li>
                {% empty %}
                <li style="background: rgba(255,255,255,0.1); padding: 10px; margin: 5px 0; border-radius: 5px; text-align: center;">
                    No hay equipos registrados
                </li>
                {% endfor %}
            </ul>
            
            {% if equipos.count > 0 %}
            <form method="post" style="margin-top: 20px;">
                {% csrf_token %}
                <button type="submit" name="eliminar_todos" style="background: #ff6b6b; width: 100%;">
                    Eliminar Todos los Equipos
                </button>
            </form>
            {% endif %}
        </div>
    </div>
    
   {% if equipos.count == 5 %}
<div style="text-align: center; margin-top: 30px;">
    <form method="post">
        {% csrf_token %}
        <button type="submit" name="realizar_sorteo" style="font-size: 1.2em; padding: 15px 30px;">
            Generar Fase de Grupos (Todos contra Todos)
        </button>
    </form>
</div>
{% else %}
<div class="card" style="text-align: center; background: rgba(255,0,0,0.3);">
    <p>Se necesitan exactamente 5 equipos para el torneo (actualmente: {{ equipos.count }})</p>
</div>
{% endif %}
</div>
{% endblock %}